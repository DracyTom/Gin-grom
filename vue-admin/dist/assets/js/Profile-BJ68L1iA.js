/* empty css             *//* empty css                   *//* empty css               *//* empty css                 *//* empty css                  *//* empty css               *//* empty css                  */import{u as h,r as v,q as j,a as k,W,c as G,d as a,w as l,a8 as H,ad as J,o as K,a9 as O,b as s,P as Q,x as X,t as w,B as C,L as i,ae as Y,j as m,E as Z,g as $,h as ee,i as ae,af as q}from"./index-DRFz7__u.js";import{f as z,v as le}from"./index-D5zCzsRw.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"profile"},oe={class:"profile-card content-card"},te={class:"profile-header"},ne={class:"profile-info"},de={class:"info-item"},ue={class:"value"},ie={class:"info-item"},me={class:"value"},pe={class:"info-item"},fe={class:"value"},_e={class:"info-item"},ce={class:"edit-card content-card"},ve={class:"password-card content-card"},we={class:"avatar-preview"},ge={__name:"Profile",setup(be){const y=h(),g=v(),_=v(),b=v(!1),V=v(!1),P=v(!1),r=j(()=>y.userInfo||{}),o=k({username:"",email:"",avatar:""}),n=k({currentPassword:"",newPassword:"",confirmPassword:""}),B={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在 3 到 50 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:(p,e,d)=>{le(e)?d():d(new Error("请输入正确的邮箱格式"))},trigger:"blur"}]},D={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(p,e,d)=>{e!==n.newPassword?d(new Error("两次输入的密码不一致")):d()},trigger:"blur"}]},E=()=>{r.value&&(o.username=r.value.username||"",o.email=r.value.email||"",o.avatar=r.value.avatar||"")},L=async()=>{if(g.value)try{await g.value.validate(),b.value=!0,await y.updateUserInfo(o)}catch(p){console.error("更新失败:",p)}finally{b.value=!1}},N=async()=>{if(_.value)try{await _.value.validate(),V.value=!0,q.success("密码修改成功"),U()}catch(p){console.error("密码修改失败:",p)}finally{V.value=!1}},S=()=>{E()},U=()=>{n.currentPassword="",n.newPassword="",n.confirmPassword="",_.value&&_.value.clearValidate()},T=()=>{if(!o.avatar){q.warning("请先输入头像URL");return}P.value=!0};return W(()=>{E()}),(p,e)=>{const d=X,x=Q,F=Y,R=O,f=ee,u=$,c=ae,I=Z,A=H,M=J;return K(),G("div",re,[a(A,{gutter:20},{default:l(()=>[a(R,{xs:24,lg:8},{default:l(()=>[s("div",oe,[s("div",te,[a(x,{size:100,src:r.value.avatar},{default:l(()=>[a(d,{size:"50"},{default:l(()=>[a(w(C))]),_:1})]),_:1},8,["src"]),s("h3",null,i(r.value.username),1),s("p",null,i(r.value.email),1),a(F,{type:r.value.role==="admin"?"danger":"primary"},{default:l(()=>[m(i(r.value.role==="admin"?"管理员":"普通用户"),1)]),_:1},8,["type"])]),s("div",ne,[s("div",de,[e[7]||(e[7]=s("span",{class:"label"},"用户ID:",-1)),s("span",ue,i(r.value.id),1)]),s("div",ie,[e[8]||(e[8]=s("span",{class:"label"},"注册时间:",-1)),s("span",me,i(w(z)(r.value.created_at)),1)]),s("div",pe,[e[9]||(e[9]=s("span",{class:"label"},"最后更新:",-1)),s("span",fe,i(w(z)(r.value.updated_at)),1)]),s("div",_e,[e[10]||(e[10]=s("span",{class:"label"},"账号状态:",-1)),a(F,{type:r.value.status===1?"success":"danger"},{default:l(()=>[m(i(r.value.status===1?"正常":"禁用"),1)]),_:1},8,["type"])])])])]),_:1}),a(R,{xs:24,lg:16},{default:l(()=>[s("div",ce,[e[14]||(e[14]=s("h3",null,"编辑个人信息",-1)),a(I,{ref_key:"profileFormRef",ref:g,model:o,rules:B,"label-width":"100px",size:"large"},{default:l(()=>[a(u,{label:"用户名",prop:"username"},{default:l(()=>[a(f,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=t=>o.username=t),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{label:"邮箱",prop:"email"},{default:l(()=>[a(f,{modelValue:o.email,"onUpdate:modelValue":e[1]||(e[1]=t=>o.email=t),placeholder:"请输入邮箱",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{label:"头像",prop:"avatar"},{default:l(()=>[a(f,{modelValue:o.avatar,"onUpdate:modelValue":e[2]||(e[2]=t=>o.avatar=t),placeholder:"请输入头像URL",clearable:""},{append:l(()=>[a(c,{onClick:T},{default:l(()=>e[11]||(e[11]=[m("预览")])),_:1,__:[11]})]),_:1},8,["modelValue"])]),_:1}),a(u,null,{default:l(()=>[a(c,{type:"primary",loading:b.value,onClick:L},{default:l(()=>e[12]||(e[12]=[m(" 保存修改 ")])),_:1,__:[12]},8,["loading"]),a(c,{onClick:S},{default:l(()=>e[13]||(e[13]=[m("重置")])),_:1,__:[13]})]),_:1})]),_:1},8,["model"])]),s("div",ve,[e[17]||(e[17]=s("h3",null,"修改密码",-1)),a(I,{ref_key:"passwordFormRef",ref:_,model:n,rules:D,"label-width":"100px",size:"large"},{default:l(()=>[a(u,{label:"当前密码",prop:"currentPassword"},{default:l(()=>[a(f,{modelValue:n.currentPassword,"onUpdate:modelValue":e[3]||(e[3]=t=>n.currentPassword=t),type:"password",placeholder:"请输入当前密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{label:"新密码",prop:"newPassword"},{default:l(()=>[a(f,{modelValue:n.newPassword,"onUpdate:modelValue":e[4]||(e[4]=t=>n.newPassword=t),type:"password",placeholder:"请输入新密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),a(u,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[a(f,{modelValue:n.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=t=>n.confirmPassword=t),type:"password",placeholder:"请确认新密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),a(u,null,{default:l(()=>[a(c,{type:"primary",loading:V.value,onClick:N},{default:l(()=>e[15]||(e[15]=[m(" 修改密码 ")])),_:1,__:[15]},8,["loading"]),a(c,{onClick:U},{default:l(()=>e[16]||(e[16]=[m("重置")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1}),a(M,{modelValue:P.value,"onUpdate:modelValue":e[6]||(e[6]=t=>P.value=t),title:"头像预览",width:"400px",center:""},{default:l(()=>[s("div",we,[a(x,{size:200,src:o.avatar},{default:l(()=>[a(d,{size:"100"},{default:l(()=>[a(w(C))]),_:1})]),_:1},8,["src"])])]),_:1},8,["modelValue"])])}}},Ce=se(ge,[["__scopeId","data-v-68f54805"]]);export{Ce as default};
